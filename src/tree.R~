### Make a tree for ddRAD2
### MKLau 28Apr2015

library(adegenet)
x <- read.genepop('../SNPs/rdata/batch_2.haplotypes_3.gen')
snp.abun <- apply(x$tab,2,sum,na.rm=TRUE)
pdf('plot.pdf');plot(snp.abun);dev.off();system('scp plot.pdf matthewklau@fas.harvard.edu:public_html')
pdf('plot.pdf');plot(as.numeric(x$loc.names));dev.off();system('scp plot.pdf matthewklau@fas.harvard.edu:public_html')
pdf('plot.pdf');plot(density(as.numeric(x$loc.names)));dev.off();system('scp plot.pdf matthewklau@fas.harvard.edu:public_html')

### Tree
rownames(x$tab) <- x$ind.names
d <- dist(x)
pdf('tree.pdf');plot(hclust(d));dev.off();system('scp tree.pdf matthewklau@fas.harvard.edu:public_html')

